<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>State of San Andreas | MDT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
   
    <style>
        body { background-color: #0f172a; color: #e2e8f0; overflow: hidden; }
        .sidebar-link { transition: all 0.2s; border-left: 4px solid transparent; }
        .sidebar-link:hover { background-color: #1e293b; border-left-color: #3b82f6; }
        .page { height: 100vh; overflow-y: auto; padding: 2rem; }
        .card { background-color: #1e293b; border-radius: 0.75rem; border: 1px solid #334155; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
    </style>
</head>
<body class="flex">
    <div id="login-screen" class="fixed inset-0 z-[100] flex items-center justify-center bg-slate-950">
        <div class="card p-8 w-96 shadow-2xl border-t-4 border-blue-500 text-center">
            <h1 class="text-2xl font-black mb-2 tracking-tighter">STATE OF SAN ANDREAS</h1>
            <p class="text-slate-500 text-xs mb-8 uppercase tracking-widest">Mobile Data Terminal</p>
            <input type="text" id="login-user" placeholder="Benutzername" class="w-full p-3 mb-4 bg-slate-900 border border-slate-700 rounded focus:border-blue-500 outline-none">
            <input type="password" id="login-pass" placeholder="Passwort" class="w-full p-3 mb-6 bg-slate-900 border border-slate-700 rounded focus:border-blue-500 outline-none">
            <button onclick="handleLogin()" class="w-full bg-blue-600 hover:bg-blue-500 py-3 rounded font-bold transition">SYSTEM LOGIN</button>
        </div>
    </div>
    <aside class="w-64 h-screen bg-slate-950 flex flex-col border-r border-slate-800">
        <div class="p-6 border-b border-slate-800">
            <div class="text-blue-500 font-black text-xl italic">MDT 3.0</div>
            <div id="current-rank" class="text-[10px] text-slate-500 uppercase mt-1">Not logged in</div>
        </div>
        <nav class="flex-1 py-4">
            <button onclick="showPage('home')" class="sidebar-link w-full text-left px-6 py-3 flex items-center">
                <span class="mr-3">üè†</span> Dashboard
            </button>
            <button onclick="showPage('persons')" class="sidebar-link w-full text-left px-6 py-3 flex items-center">
                <span class="mr-3">üë§</span> Personen
            </button>
            <button onclick="showPage('vehicles')" class="sidebar-link w-full text-left px-6 py-3 flex items-center">
                <span class="mr-3">üöì</span> Fahrzeuge
            </button>
            <button onclick="showPage('reports')" class="sidebar-link w-full text-left px-6 py-3 flex items-center">
                <span class="mr-3">üìÑ</span> Berichte
            </button>
            <button onclick="showPage('calculator')" class="sidebar-link w-full text-left px-6 py-3 flex items-center text-yellow-500">
                <span class="mr-3">‚öñÔ∏è</span> Strafrechner
            </button>
            <button onclick="showPage('employees')" class="sidebar-link w-full text-left px-6 py-3 flex items-center mt-8 border-t border-slate-800 pt-6">
                <span class="mr-3">üë•</span> Beamte
            </button>
        </nav>
        <div class="p-4 bg-slate-900 text-[10px] text-slate-500 text-center">
            OFFICIAL DOJ PROPERTY
        </div>
    </aside>
    <main class="flex-1 relative">
       
        <section id="page-home" class="page">
            <h2 class="text-3xl font-bold mb-8">System√ºbersicht</h2>
            <div class="grid grid-cols-2 gap-6 mb-8">
                <div class="card p-6 border-l-4 border-blue-500">
                    <h3 class="text-sm text-slate-400 mb-2 uppercase">Personen-Schnellsuche</h3>
                    <input type="text" onkeyup="if(event.key === 'Enter') { showPage('persons'); searchPerson(this.value); }" class="w-full p-2 bg-slate-900 rounded border border-slate-700" placeholder="Name tippen...">
                </div>
                <div class="card p-6 border-l-4 border-yellow-500">
                    <h3 class="text-sm text-slate-400 mb-2 uppercase">KFZ-Abfrage</h3>
                    <input type="text" onkeyup="if(event.key === 'Enter') { showPage('vehicles'); searchVehicle(this.value); }" class="w-full p-2 bg-slate-900 rounded border border-slate-700 uppercase" placeholder="Kennzeichen...">
                </div>
            </div>
            <div class="card p-6">
                <h3 class="text-red-500 font-bold flex items-center mb-4">
                    <span class="w-2 h-2 bg-red-500 rounded-full animate-ping mr-3"></span> AKTUELLE FAHNDUNGEN
                </h3>
                <table class="w-full text-left">
                    <thead><tr class="text-xs text-slate-500 border-b border-slate-800">
                        <th class="pb-2">Name</th><th class="pb-2">Status</th><th class="pb-2 text-right">Aktion</th>
                    </tr></thead>
                    <tbody id="wanted-list-body"></tbody>
                </table>
            </div>
        </section>
        <section id="page-persons" class="page hidden">
            <div class="flex justify-between mb-6">
                <h2 class="text-3xl font-bold">Personenregister</h2>
                <button onclick="document.getElementById('modal-person').classList.remove('hidden')" class="bg-blue-600 px-4 py-2 rounded font-bold hover:bg-blue-500">+ Registrieren</button>
            </div>
            <input type="text" id="search-person-input" onkeyup="searchPerson()" class="w-full p-3 bg-slate-800 rounded mb-8" placeholder="Suche nach Name, Alias oder Geburtsdatum...">
            <div id="person-results" class="grid grid-cols-3 gap-6"></div>
        </section>
        <section id="page-vehicles" class="page hidden">
            <div class="flex justify-between mb-6">
                <h2 class="text-3xl font-bold">Fahrzeugdatenbank</h2>
                <button onclick="document.getElementById('modal-vehicle').classList.remove('hidden')" class="bg-blue-600 px-4 py-2 rounded font-bold hover:bg-blue-500">+ KFZ Hinzuf√ºgen</button>
            </div>
            <div id="vehicle-results" class="grid grid-cols-3 gap-6"></div>
        </section>
        <section id="page-reports" class="page hidden">
            <div class="flex justify-between mb-6">
                <h2 class="text-3xl font-bold">Einsatzberichte</h2>
                <button onclick="openReportModal()" class="bg-blue-600 px-4 py-2 rounded font-bold hover:bg-blue-500">+ Neuer Bericht</button>
            </div>
            <div id="report-list" class="space-y-4"></div>
        </section>
        <section id="page-calculator" class="page hidden">
            <h2 class="text-3xl font-bold mb-6">Strafrechner</h2>
            <div class="card p-6">
                <input type="text" id="penalty-input" placeholder="Straftat eingeben..." class="w-full p-2 bg-slate-900 rounded border border-slate-700 mb-4">
                <button onclick="calculatePenalty()" class="bg-blue-600 px-4 py-2 rounded font-bold hover:bg-blue-500">Berechnen</button>
                <div id="penalty-result" class="mt-4 text-yellow-500"></div>
            </div>
        </section>
        <section id="page-employees" class="page hidden">
            <h2 class="text-3xl font-bold mb-6">Beamtenverwaltung</h2>
            <div id="employee-list" class="grid grid-cols-2 gap-4"></div>
        </section>
    </main>
    <div id="modal-person" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 hidden">
        <div class="card p-8 w-[600px]">
            <h2 class="text-xl font-bold mb-6">Neue Person anlegen</h2>
            <div class="grid grid-cols-2 gap-4 mb-6">
                <input id="p-firstname" type="text" placeholder="Vorname" class="p-2 bg-slate-900 border border-slate-700 rounded">
                <input id="p-lastname" type="text" placeholder="Nachname" class="p-2 bg-slate-900 border border-slate-700 rounded">
                <input id="p-dob" type="date" class="p-2 bg-slate-900 border border-slate-700 rounded">
                <input id="p-height" type="number" placeholder="Gr√∂√üe (cm)" class="p-2 bg-slate-900 border border-slate-700 rounded">
            </div>
            <div class="flex flex-wrap gap-2 mb-8">
                <button onclick="toggleTag(this)" data-tag="Wanted" class="tag-btn border border-red-500 text-red-500 px-3 py-1 rounded text-xs">WANTED</button>
                <button onclick="toggleTag(this)" data-tag="Driver A" class="tag-btn border border-slate-500 px-3 py-1 rounded text-xs">LIZENZ A</button>
                <button onclick="toggleTag(this)" data-tag="Driver B" class="tag-btn border border-slate-500 px-3 py-1 rounded text-xs">LIZENZ B</button>
                <button onclick="toggleTag(this)" data-tag="Weapons" class="tag-btn border border-slate-500 px-3 py-1 rounded text-xs">WAFFENSCHEIN</button>
            </div>
            <div class="flex justify-end gap-4">
                <button onclick="this.closest('#modal-person').classList.add('hidden')" class="text-slate-400">Abbrechen</button>
                <button onclick="savePerson()" class="bg-blue-600 px-6 py-2 rounded font-bold">Speichern</button>
            </div>
        </div>
    </div>
    <div id="modal-vehicle" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 hidden">
        <div class="card p-8 w-[500px]">
            <h2 class="text-xl font-bold mb-6">Fahrzeug registrieren</h2>
            <div class="space-y-4 mb-8">
                <input id="v-plate" type="text" placeholder="KENNZEICHEN" class="w-full p-2 bg-slate-900 border border-slate-700 rounded uppercase">
                <input id="v-model" type="text" placeholder="Modellbezeichnung" class="w-full p-2 bg-slate-900 border border-slate-700 rounded">
                <div class="relative">
                    <input id="v-owner-search" onkeyup="liveSearchOwner(this.value)" type="text" placeholder="Besitzer suchen..." class="w-full p-2 bg-slate-900 border border-slate-700 rounded">
                    <div id="owner-dropdown" class="absolute w-full bg-slate-800 border border-slate-700 rounded mt-1 hidden max-h-40 overflow-y-auto"></div>
                </div>
                <div id="selected-owner-display" class="text-blue-400 font-bold text-sm"></div>
                <input type="hidden" id="v-owner-id">
            </div>
            <div class="flex justify-end gap-4">
                <button onclick="this.closest('#modal-vehicle').classList.add('hidden')" class="text-slate-400">Abbrechen</button>
                <button onclick="saveVehicle()" class="bg-blue-600 px-6 py-2 rounded font-bold">KFZ Speichern</button>
            </div>
        </div>
    </div>
    <div id="modal-report" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 hidden">
        <div class="card p-8 w-[600px]">
            <h2 class="text-xl font-bold mb-6">Neuen Bericht erstellen</h2>
            <textarea id="r-content" placeholder="Berichtsinhalt..." class="w-full h-40 p-2 bg-slate-900 border border-slate-700 rounded mb-6"></textarea>
            <div class="flex justify-end gap-4">
                <button onclick="closeModal()" class="text-slate-400">Abbrechen</button>
                <button onclick="saveReport(); closeModal();" class="bg-blue-600 px-6 py-2 rounded font-bold">Speichern</button>
            </div>
        </div>
    </div>
    <script src="app.js"></script>
</body>
</html>
